from app.db import Base
from sqlalchemy.engine import Engine

db_content = [
    # Customer 1, Product 1
    {
        "transaction_id": "11111111-1111-1111-1111-111111111111",
        "customer_id": "22222222-2222-2222-2222-222222222222",
        "product_id": "33333333-3333-3333-3333-333333333333",
        "amount": 100.0,
        "currency": "USD",
        "quantity": 1,
        "timestamp": "2024-01-01T00:00:00",
    },
    # Customer 2, Product 1
    {
        "transaction_id": "21111111-1111-1111-1111-111111111111",
        "customer_id": "22242222-2222-2222-2222-222222222222",
        "product_id": "33333333-3333-3333-3333-333333333333",
        "amount": 200.0,
        "currency": "EUR",
        "quantity": 2,
        "timestamp": "2024-01-02T00:00:00",
    },
    # Customer 3, Product 2
    {
        "transaction_id": "31111111-1111-1111-1111-111111111111",
        "customer_id": "22225222-2222-2222-2222-222222222222",
        "product_id": "33334444-3333-3333-3333-333333333333",
        "amount": 300.0,
        "currency": "PLN",
        "quantity": 3,
        "timestamp": "2024-01-03T00:00:00",
    },
    # Customer 1, Product 3
    {
        "transaction_id": "41111111-1111-1111-1111-111111111111",
        "customer_id": "22222222-2222-2222-2222-222222222222",
        "product_id": "33335555-3333-3333-3333-333333333333",
        "amount": 400.0,
        "currency": "USD",
        "quantity": 4,
        "timestamp": "2024-01-04T00:00:00",
    },
    # Customer 4, Product 1
    {
        "transaction_id": "51111111-1111-1111-1111-111111111111",
        "customer_id": "22262222-2222-2222-2222-222222222222",
        "product_id": "33333333-3333-3333-3333-333333333333",
        "amount": 500.0,
        "currency": "EUR",
        "quantity": 5,
        "timestamp": "2024-01-05T00:00:00",
    },
    # Customer 1, Product 4
    {
        "transaction_id": "61111111-1111-1111-1111-111111111111",
        "customer_id": "22222222-2222-2222-2222-222222222222",
        "product_id": "33336666-3333-3333-3333-333333333333",
        "amount": 600.0,
        "currency": "PLN",
        "quantity": 6,
        "timestamp": "2024-01-06T00:00:00",
    },
    # Customer 1, Product 5
    {
        "transaction_id": "71111111-1111-1111-1111-111111111111",
        "customer_id": "22222222-2222-2222-2222-222222222222",
        "product_id": "33337777-3333-3333-3333-333333333333",
        "amount": 700.0,
        "currency": "USD",
        "quantity": 7,
        "timestamp": "2024-01-07T00:00:00",
    },
]

dirty_csv_content = (
    "transaction_id,customer_id,product_id,amount,currency,quantity,timestamp\n"
    "11111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,100.00,USD,1,2024-01-01T00:00:00\n"
    "21111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,200.00,EUR,2,2024-01-02T00:00:00\n"
    "31111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3323-333333333333,300.00,PLN,3,2024-01-03T00:00:00\n"
    "41111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333553-3333-3333-3333-333333333333,400.00,USD,4,2024-01-04T00:00:00\n"
    "51111111-1111-1111-1111-111111111111,22262222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,500.00,EUR,5,2024-01-05T00:00:00\n"
    "61111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33336333-3333-3333-3333-333333333333,600.00,PLN,6,2024-01-06T00:00:00\n"
    "71111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33332333-3333-3333-3333-333333333333,700.00,USD,7,2024-01-07T00:00:00\n"
    "a2111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,800.00,XXX,8,2024-01-08T00:00:00\n"  # invalid currency
    "b3111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,,USD,9,2024-01-09T00:00:00\n"  # missing 'amount' column
    "c4111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,notanumber,USD,10,2024-01-10T00:00:00\n"  # non-numeric amount
    "d5111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,999999999999999999999999.99,USD,11,2024-01-11T00:00:00\n"  # amount too large
    "11111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,1200.00,USD,12,2024-01-12T00:00:00\n"  # duplicate transaction_id
    "e6111111-1111-1111-1111-111111111111,22222222-2222-2222-2222-222222222222,33333333-3333-3333-3333-333333333333,1300.00,USD,13,2024-01-13T00:00:00,EXTRA\n"  # malformed row
)


def create_test_tables(engine: Engine):
    Base.metadata.create_all(bind=engine)
